"0","set.seed(1)"
"0","dataframe.resultados.1neu.soft <- data.frame(Ent_1Neu_soft = numeric(),"
"0","                                             Test_1Neu_soft = numeric())"
"0","conf.1neu.s <- vector(mode = ""list"", length = 50)"
"0","for(i in 1:50)"
"0","{"
"0","  pacientes.1neu.softmax <- nnet( matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24],"
"0","                                  class.ind( matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ),"
"0","                                  size=1,"
"0","                                  softmax = T,"
"0","                                  trace = F)"
"0","  #Una vez que lo tengo entrenado, lo que voy a hacer es calcular el error tanto en el entrenamiento como en el test de cada uno"
"0","  "
"0","  pacientes.prediccion.1neu.softmax <- predict( pacientes.1neu.softmax, "
"0","                                                matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], "
"0","                                                type=""raw"" )"
"0","  head(pacientes.prediccion.1neu.softmax) # Vemos las probabilidades de pertenencia de cada valor"
"0","  "
"0","  # Ahora que los tengo todos entrenados, Determinamos cual es la máxima, es decir, la clase a la que hay que asignar los objetos"
"0","  "
"0","  pacientes.prediccion.1neu.class.softmax <- apply( pacientes.prediccion.1neu.softmax, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.1neu.class.softmax"
"0","  "
"0","  # Lo visualizo en forma de tabla para ir viendo el error"
"0","  "
"0","  table( pacientes.prediccion.1neu.class.softmax, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] )  # Lo vemos en forma de tabla."
"0","  "
"0","  #Calculo el acierto"
"0","  "
"0","  acierto.ent.teorico.1neu.soft <- sum( diag( table( pacientes.prediccion.1neu.class.softmax, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) ) )/55 # Esta cuenta nos da el índice de acierto"
"0","  "
"0","  #TEST"
"0","  "
"0","  pacientes.prediccion.test.1neu.softmax <- predict( pacientes.1neu.softmax,"
"0","                                                     matriz.pacientes.datos.centscal[-conjuntoEntrenamiento, 1:24], "
"0","                                                     type=""raw"" )"
"0","  pacientes.prediccion.test.1neu.softmax"
"0","  "
"0","  pacientes.prediccion.test.1neu.class.softmax <- apply( pacientes.prediccion.test.1neu.softmax, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.test.1neu.class.softmax"
"0","  "
"0","  conf.1neu.s[[i]] <- table( pacientes.prediccion.test.1neu.class.softmax , matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] )"
"0","  acierto.test.teorico.1neu.soft <- sum(diag(table(pacientes.prediccion.test.1neu.class.softmax, matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25])))/12"
"0","  "
"0","  dataframe.pasada <- data.frame(Ent_1Neu_soft = acierto.ent.teorico.1neu.soft,"
"0","                                 Test_1Neu_soft = acierto.test.teorico.1neu.soft)"
"0","  "
"0","  dataframe.resultados.1neu.soft <- rbind(dataframe.resultados.1neu.soft ,dataframe.pasada)"
"0","  "
"0","}"
"0","head(dataframe.resultados.1neu.soft[order(dataframe.resultados.1neu.soft$Test_1Neu_soft, decreasing = T), ])"
