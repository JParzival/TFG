"0","set.seed(1)"
"0","dataframe.resultados.1neu <- data.frame(Ent_1Neu = numeric(),"
"0","                                        Test_1Neu = numeric())"
"0","for(i in 1:20)"
"0","{"
"0","  pacientes.1neu <- nnet( matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], class.ind( matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) , size=1)"
"0","  #Una vez que lo tengo entrenado, lo que voy a hacer es calcular el error tanto en el entrenamiento como en el test de cada uno"
"0","  "
"0","  pacientes.prediccion.1neu <- predict( pacientes.1neu, matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], type=""raw"" )"
"0","  head(pacientes.prediccion.1neu) # Vemos las probabilidades de pertenencia de cada valor"
"0","  "
"0","  # Ahora que los tengo todos entrenados, Determinamos cual es la mÃ¡xima, es decir, la clase a la que hay que asignar los objetos"
"0","  "
"0","  pacientes.prediccion.1neu.class <- apply( pacientes.prediccion.1neu, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.1neu.class"
"0","  "
"0","  # Lo visualizo en forma de tabla para ir viendo el error"
"0","  "
"0","  table( pacientes.prediccion.1neu.class, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] )  # Lo vemos en forma de tabla."
"0","  "
"0","  #Calculo el acierto"
"0","  "
"0","  acierto.ent.teorico.1neu <- sum( diag( table( pacientes.prediccion.1neu.class, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) ) )/55 # Esta cuenta nos da el Ã­ndice de acierto"
"0","  "
"0","  #TEST"
"0","  "
"0","  pacientes.prediccion.test.1neu <- predict( pacientes.1neu, matriz.pacientes.datos.centscal[-conjuntoEntrenamiento, 1:24], type=""raw"" )"
"0","  pacientes.prediccion.test.1neu"
"0","  "
"0","  pacientes.prediccion.test.1neu.class <- apply( pacientes.prediccion.test.1neu, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.test.1neu.class"
"0","  "
"0","  table( pacientes.prediccion.test.1neu.class , matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] )"
"0","  acierto.test.teorico.1neu <- sum( diag( table( pacientes.prediccion.test.1neu.class, matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] ) ) )/12"
"0","  "
"0","  dataframe.pasada <- data.frame(Ent_1Neu = acierto.ent.teorico.1neu,"
"0","                                 Test_1Neu = acierto.test.teorico.1neu)"
"0","  "
"0","  dataframe.resultados.1neu <- rbind(dataframe.resultados.1neu, dataframe.pasada)"
"0","}"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 50.804394 
"
"1","iter  10 value 28.883695
"
"1","iter  20 value 28.108004
"
"1","iter  30 value 27.519858
"
"1","iter  40 value 27.382838
"
"1","iter  50 value 27.310965
"
"1","iter  60 value 27.274248
"
"1","iter  70 value 26.068841
"
"1","iter  80 value 26.013034
"
"1","iter  90 value 26.000207
"
"1","iter 100 value 25.975006
"
"1","final  value 25.975006 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.416568 
"
"1","iter  10 value 39.736422
"
"1","iter  20 value 33.178644
"
"1","iter  30 value 32.675710
"
"1","iter  40 value 29.706651
"
"1","iter  50 value 28.143997
"
"1","iter  60 value 27.879434
"
"1","iter  70 value 27.774306
"
"1","iter  80 value 27.588526
"
"1","iter  90 value 27.560983
"
"1","iter 100 value 27.351533
"
"1","final  value 27.351533 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 59.893288 
"
"1","iter  10 value 36.070304
"
"1","iter  20 value 29.010319
"
"1","iter  30 value 28.599371
"
"1","iter  40 value 28.213082
"
"1","iter  50 value 26.989191
"
"1","iter  60 value 26.526070
"
"1","iter  70 value 26.039561
"
"1","iter  80 value 25.512451
"
"1","iter  90 value 25.478196
"
"1","iter 100 value 25.139028
"
"1","final  value 25.139028 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 53.169407 
"
"1","iter  10 value 34.020538
"
"1","iter  20 value 32.033713
"
"1","iter  30 value 31.880255
"
"1","iter  40 value 31.850829
"
"1","iter  50 value 31.849592
"
"1","iter  60 value 31.839751
"
"1","iter  70 value 31.823156
"
"1","iter  80 value 31.510166
"
"1","iter  90 value 31.223868
"
"1","iter 100 value 27.065576
"
"1","final  value 27.065576 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 64.807079 
"
"1","iter  10 value 30.999607
"
"1","iter  20 value 28.839072
"
"1","iter  30 value 28.155248
"
"1","iter  40 value 28.097934
"
"1","iter  50 value 27.978673
"
"1","iter  60 value 27.944450
"
"1","iter  70 value 27.938687
"
"1","iter  80 value 27.938394
"
"1","iter  90 value 27.938381
"
"1","final  value 27.938367 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.407241 
"
"1","iter  10 value 33.031921
"
"1","iter  20 value 31.868999
"
"1","iter  30 value 31.846788
"
"1","iter  40 value 29.016215
"
"1","iter  50 value 28.342615
"
"1","iter  60 value 28.181972
"
"1","iter  70 value 28.170855
"
"1","iter  80 value 28.168245
"
"1","iter  90 value 27.875298
"
"1","iter 100 value 24.086138
"
"1","final  value 24.086138 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.470491 
"
"1","iter  10 value 35.869919
"
"1","iter  20 value 33.046397
"
"1","iter  30 value 31.367381
"
"1","iter  40 value 30.161467
"
"1","iter  50 value 29.959292
"
"1","iter  60 value 29.731038
"
"1","iter  70 value 29.609419
"
"1","iter  80 value 29.385731
"
"1","iter  90 value 29.330903
"
"1","iter 100 value 29.315228
"
"1","final  value 29.315228 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.092013 
"
"1","iter  10 value 34.353488
"
"1","iter  20 value 30.070186
"
"1","iter  30 value 29.739061
"
"1","iter  40 value 29.181151
"
"1","iter  50 value 28.796948
"
"1","iter  60 value 28.685028
"
"1","iter  70 value 28.131444
"
"1","iter  80 value 27.982451
"
"1","iter  90 value 25.637094
"
"1","iter 100 value 25.280109
"
"1","final  value 25.280109 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 47.551221 
"
"1","iter  10 value 30.862409
"
"1","iter  20 value 28.460312
"
"1","iter  30 value 27.432976
"
"1","iter  40 value 27.406675
"
"1","iter  50 value 27.405391
"
"1","iter  60 value 27.133782
"
"1","iter  70 value 27.121231
"
"1","final  value 27.121218 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 76.731378 
"
"1","iter  10 value 37.183599
"
"1","iter  20 value 34.187641
"
"1","iter  30 value 34.151415
"
"1","iter  40 value 33.449203
"
"1","iter  50 value 33.448011
"
"1","iter  60 value 33.447844
"
"1","iter  70 value 33.446672
"
"1","iter  80 value 33.401094
"
"1","iter  90 value 33.085402
"
"1","iter 100 value 32.048276
"
"1","final  value 32.048276 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.536041 
"
"1","iter  10 value 36.795540
"
"1","iter  20 value 32.769562
"
"1","iter  30 value 31.900362
"
"1","iter  40 value 31.822931
"
"1","iter  50 value 30.224080
"
"1","iter  60 value 29.966617
"
"1","iter  70 value 29.776366
"
"1","iter  80 value 29.698192
"
"1","iter  90 value 29.575982
"
"1","iter 100 value 29.538672
"
"1","final  value 29.538672 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 55.305588 
"
"1","iter  10 value 34.044665
"
"1","iter  20 value 33.461172
"
"1","iter  30 value 33.446416
"
"1","iter  40 value 33.444900
"
"1","iter  50 value 33.432182
"
"1","iter  60 value 30.569107
"
"1","iter  70 value 29.268483
"
"1","iter  80 value 25.658004
"
"1","iter  90 value 25.403437
"
"1","iter 100 value 25.082742
"
"1","final  value 25.082742 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 60.805775 
"
"1","iter  10 value 34.155159
"
"1","iter  20 value 32.813474
"
"1","iter  30 value 27.762614
"
"1","iter  40 value 27.382307
"
"1","iter  50 value 26.973397
"
"1","iter  60 value 26.681109
"
"1","iter  70 value 26.610542
"
"1","iter  80 value 26.588150
"
"1","iter  90 value 26.363424
"
"1","iter 100 value 26.302704
"
"1","final  value 26.302704 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.032413 
"
"1","iter  10 value 29.064717
"
"1","iter  20 value 25.772053
"
"1","iter  30 value 23.460421
"
"1","iter  40 value 22.386944
"
"1","iter  50 value 21.777677
"
"1","iter  60 value 21.529265
"
"1","iter  70 value 21.225567
"
"1","iter  80 value 21.179285
"
"1","iter  90 value 21.171199
"
"1","iter 100 value 21.165989
"
"1","final  value 21.165989 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.926652 
"
"1","iter  10 value 33.056722
"
"1","iter  20 value 31.871827
"
"1","iter  30 value 31.729763
"
"1","iter  40 value 30.024872
"
"1","iter  50 value 29.900317
"
"1","iter  60 value 29.741699
"
"1","iter  70 value 29.671265
"
"1","iter  80 value 27.762586
"
"1","iter  90 value 26.177386
"
"1","iter 100 value 22.772790
"
"1","final  value 22.772790 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 74.326378 
"
"1","iter  10 value 36.950799
"
"1","iter  20 value 34.669140
"
"1","iter  30 value 34.409465
"
"1","iter  40 value 33.556855
"
"1","iter  50 value 33.544955
"
"1","iter  60 value 33.512993
"
"1","iter  70 value 33.295426
"
"1","iter  80 value 29.038440
"
"1","iter  90 value 28.858502
"
"1","iter 100 value 28.815830
"
"1","final  value 28.815830 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 67.774377 
"
"1","iter  10 value 34.908452
"
"1","iter  20 value 32.821194
"
"1","iter  30 value 32.743064
"
"1","iter  40 value 32.473554
"
"1","iter  50 value 29.027760
"
"1","iter  60 value 24.457787
"
"1","iter  70 value 24.383357
"
"1","iter  80 value 24.304846
"
"1","iter  90 value 24.033168
"
"1","iter 100 value 23.947837
"
"1","final  value 23.947837 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 61.940862 
"
"1","iter  10 value 37.761206
"
"1","iter  20 value 34.274611
"
"1","iter  30 value 33.521134
"
"1","iter  40 value 33.451000
"
"1","iter  50 value 33.447775
"
"1","iter  60 value 33.431406
"
"1","iter  70 value 33.300958
"
"1","iter  80 value 33.075824
"
"1","iter  90 value 29.165173
"
"1","iter 100 value 29.159532
"
"1","final  value 29.159532 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 53.782434 
"
"1","iter  10 value 32.590312
"
"1","iter  20 value 31.854670
"
"1","iter  30 value 31.831850
"
"1","iter  40 value 31.825694
"
"1","iter  50 value 31.809197
"
"1","iter  60 value 31.729544
"
"1","iter  70 value 31.321510
"
"1","iter  80 value 27.353643
"
"1","iter  90 value 27.274380
"
"1","iter 100 value 27.214538
"
"1","final  value 27.214538 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 64.057583 
"
"1","iter  10 value 35.007414
"
"1","iter  20 value 33.356263
"
"1","iter  30 value 29.451479
"
"1","iter  40 value 29.297197
"
"1","iter  50 value 29.229990
"
"1","iter  60 value 29.000834
"
"1","iter  70 value 27.690035
"
"1","iter  80 value 27.517198
"
"1","iter  90 value 27.373906
"
"1","iter 100 value 27.360879
"
"1","final  value 27.360879 
"
"1","stopped after 100 iterations
"
