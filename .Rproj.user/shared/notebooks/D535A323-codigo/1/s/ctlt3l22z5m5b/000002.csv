"0","set.seed(1)"
"0","dataframe.resultados.1neu <- data.frame(Ent_1Neu = numeric(),"
"0","                                        Test_1Neu = numeric())"
"0","for(i in 1:20)"
"0","{"
"0","  pacientes.1neu <- nnet( matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], class.ind( matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) , size=1)"
"0","  #Una vez que lo tengo entrenado, lo que voy a hacer es calcular el error tanto en el entrenamiento como en el test de cada uno"
"0","  "
"0","  pacientes.prediccion.1neu <- predict( pacientes.1neu, matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], type=""raw"" )"
"0","  head(pacientes.prediccion.1neu) # Vemos las probabilidades de pertenencia de cada valor"
"0","  "
"0","  # Ahora que los tengo todos entrenados, Determinamos cual es la mÃ¡xima, es decir, la clase a la que hay que asignar los objetos"
"0","  "
"0","  pacientes.prediccion.1neu.class <- apply( pacientes.prediccion.1neu, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.1neu.class"
"0","  "
"0","  # Lo visualizo en forma de tabla para ir viendo el error"
"0","  "
"0","  table( pacientes.prediccion.1neu.class, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] )  # Lo vemos en forma de tabla."
"0","  "
"0","  #Calculo el acierto"
"0","  "
"0","  acierto.ent.teorico.1neu <- sum( diag( table( pacientes.prediccion.1neu.class, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) ) )/55 # Esta cuenta nos da el Ã­ndice de acierto"
"0","  "
"0","  #TEST"
"0","  "
"0","  pacientes.prediccion.test.1neu <- predict( pacientes.1neu, matriz.pacientes.datos.centscal[-conjuntoEntrenamiento, 1:24], type=""raw"" )"
"0","  pacientes.prediccion.test.1neu"
"0","  "
"0","  pacientes.prediccion.test.1neu.class <- apply( pacientes.prediccion.test.1neu, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.test.1neu.class"
"0","  "
"0","  table( pacientes.prediccion.test.1neu.class , matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] )"
"0","  acierto.test.teorico.1neu <- sum( diag( table( pacientes.prediccion.test.1neu.class, matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] ) ) )/12"
"0","  "
"0","  dataframe.pasada <- data.frame(Ent_1Neu = acierto.ent.teorico.1neu,"
"0","                                 Test_1Neu = acierto.test.teorico.1neu)"
"0","  "
"0","  dataframe.resultados.1neu <- rbind(dataframe.resultados.1neu, dataframe.pasada)"
"0","}"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 50.829942 
"
"1","iter  10 value 25.530178
"
"1","iter  20 value 24.936914
"
"1","iter  30 value 24.275090
"
"1","iter  40 value 23.918913
"
"1","iter  50 value 23.872897
"
"1","iter  60 value 23.860218
"
"1","iter  70 value 23.858148
"
"1","iter  80 value 23.857937
"
"1","iter  90 value 23.857917
"
"1","final  value 23.857917 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.485263 
"
"1","iter  10 value 45.013144
"
"1","iter  20 value 37.428597
"
"1","iter  30 value 36.661782
"
"1","iter  40 value 36.541612
"
"1","iter  50 value 29.591636
"
"1","iter  60 value 29.386290
"
"1","iter  70 value 29.009526
"
"1","iter  80 value 28.946513
"
"1","iter  90 value 28.868534
"
"1","iter 100 value 28.567240
"
"1","final  value 28.567240 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 61.470591 
"
"1","iter  10 value 46.186864
"
"1","iter  20 value 29.280247
"
"1","iter  30 value 27.388793
"
"1","iter  40 value 26.927982
"
"1","iter  50 value 26.174690
"
"1","iter  60 value 25.523221
"
"1","iter  70 value 25.483898
"
"1","iter  80 value 25.371980
"
"1","iter  90 value 25.138414
"
"1","iter 100 value 23.285947
"
"1","final  value 23.285947 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 52.918512 
"
"1","iter  10 value 36.863053
"
"1","iter  20 value 36.575891
"
"1","iter  30 value 36.544844
"
"1","iter  40 value 36.541411
"
"1","iter  50 value 32.947999
"
"1","iter  60 value 31.934349
"
"1","iter  70 value 31.920928
"
"1","iter  80 value 31.919548
"
"1","final  value 31.919474 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 64.621467 
"
"1","iter  10 value 32.512865
"
"1","iter  20 value 30.304692
"
"1","iter  30 value 28.686179
"
"1","iter  40 value 28.624224
"
"1","iter  50 value 28.623993
"
"1","final  value 28.623964 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.095756 
"
"1","iter  10 value 36.075774
"
"1","iter  20 value 35.462767
"
"1","iter  30 value 31.791852
"
"1","iter  40 value 31.330358
"
"1","iter  50 value 26.952220
"
"1","iter  60 value 25.564949
"
"1","iter  70 value 25.269105
"
"1","iter  80 value 24.480168
"
"1","iter  90 value 23.853058
"
"1","iter 100 value 23.796170
"
"1","final  value 23.796170 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 55.275447 
"
"1","iter  10 value 39.019365
"
"1","iter  20 value 38.969453
"
"1","iter  30 value 38.966598
"
"1","iter  40 value 38.962907
"
"1","iter  50 value 38.957828
"
"1","iter  60 value 38.950302
"
"1","iter  70 value 38.937919
"
"1","iter  80 value 38.913950
"
"1","iter  90 value 38.854309
"
"1","iter 100 value 38.710843
"
"1","final  value 38.710843 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.291789 
"
"1","iter  10 value 26.550813
"
"1","iter  20 value 25.033587
"
"1","iter  30 value 24.583364
"
"1","iter  40 value 24.500184
"
"1","iter  50 value 24.444118
"
"1","iter  60 value 24.436192
"
"1","iter  70 value 24.435064
"
"1","final  value 24.435053 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 48.581746 
"
"1","iter  10 value 29.209584
"
"1","iter  20 value 27.939253
"
"1","iter  30 value 26.239218
"
"1","iter  40 value 26.228734
"
"1","iter  50 value 26.224842
"
"1","iter  60 value 26.217597
"
"1","iter  70 value 26.027758
"
"1","iter  80 value 25.879132
"
"1","iter  90 value 25.870945
"
"1","iter 100 value 24.863359
"
"1","final  value 24.863359 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 65.592061 
"
"1","iter  10 value 51.904947
"
"1","iter  20 value 37.455152
"
"1","iter  30 value 35.737886
"
"1","iter  40 value 35.622364
"
"1","iter  50 value 28.715395
"
"1","iter  60 value 28.405247
"
"1","iter  70 value 27.881847
"
"1","iter  80 value 26.138434
"
"1","iter  90 value 24.597936
"
"1","iter 100 value 24.405981
"
"1","final  value 24.405981 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.757805 
"
"1","iter  10 value 41.852122
"
"1","iter  20 value 39.616433
"
"1","iter  30 value 38.656865
"
"1","iter  40 value 38.567019
"
"1","iter  50 value 32.550711
"
"1","iter  60 value 32.265811
"
"1","iter  70 value 31.422272
"
"1","iter  80 value 30.078797
"
"1","iter  90 value 29.960561
"
"1","iter 100 value 29.736059
"
"1","final  value 29.736059 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.922944 
"
"1","iter  10 value 35.732133
"
"1","iter  20 value 27.405943
"
"1","iter  30 value 25.140678
"
"1","iter  40 value 24.744425
"
"1","iter  50 value 24.609745
"
"1","iter  60 value 24.401071
"
"1","iter  70 value 24.333978
"
"1","iter  80 value 24.073531
"
"1","iter  90 value 24.010299
"
"1","iter 100 value 23.964773
"
"1","final  value 23.964773 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 60.448436 
"
"1","iter  10 value 37.155441
"
"1","iter  20 value 37.071957
"
"1","iter  30 value 37.067598
"
"1","iter  40 value 37.057970
"
"1","iter  50 value 34.024802
"
"1","iter  60 value 30.066920
"
"1","iter  70 value 29.440748
"
"1","iter  80 value 29.046844
"
"1","iter  90 value 29.004745
"
"1","iter 100 value 28.837428
"
"1","final  value 28.837428 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 48.592404 
"
"1","iter  10 value 26.181247
"
"1","iter  20 value 24.739324
"
"1","iter  30 value 23.847182
"
"1","iter  40 value 23.085421
"
"1","iter  50 value 22.919015
"
"1","iter  60 value 22.696855
"
"1","iter  70 value 22.631350
"
"1","iter  80 value 22.629078
"
"1","iter  90 value 22.625253
"
"1","iter 100 value 22.617520
"
"1","final  value 22.617520 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.783643 
"
"1","iter  10 value 28.184759
"
"1","iter  20 value 26.097892
"
"1","iter  30 value 24.639257
"
"1","iter  40 value 24.235699
"
"1","iter  50 value 24.007348
"
"1","iter  60 value 23.969284
"
"1","iter  70 value 23.961229
"
"1","iter  80 value 23.960846
"
"1","iter  90 value 23.960826
"
"1","final  value 23.960817 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 68.656522 
"
"1","iter  10 value 39.251594
"
"1","iter  20 value 35.782308
"
"1","iter  30 value 35.647431
"
"1","iter  40 value 35.639815
"
"1","iter  50 value 35.639456
"
"1","iter  60 value 35.639242
"
"1","iter  70 value 35.637381
"
"1","iter  80 value 35.606434
"
"1","iter  90 value 35.385333
"
"1","iter 100 value 28.626880
"
"1","final  value 28.626880 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 64.470713 
"
"1","iter  10 value 39.008173
"
"1","iter  20 value 35.648709
"
"1","iter  30 value 34.840963
"
"1","iter  40 value 34.831162
"
"1","iter  50 value 34.811056
"
"1","iter  60 value 34.800220
"
"1","iter  70 value 34.793654
"
"1","iter  80 value 34.780821
"
"1","iter  90 value 34.742456
"
"1","iter 100 value 28.480411
"
"1","final  value 28.480411 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 60.208502 
"
"1","iter  10 value 46.884205
"
"1","iter  20 value 32.955271
"
"1","iter  30 value 29.886023
"
"1","iter  40 value 28.762792
"
"1","iter  50 value 28.059475
"
"1","iter  60 value 27.724816
"
"1","iter  70 value 26.958389
"
"1","iter  80 value 26.939820
"
"1","iter  90 value 26.937229
"
"1","iter 100 value 26.919711
"
"1","final  value 26.919711 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 47.432687 
"
"1","iter  10 value 27.111488
"
"1","iter  20 value 25.715559
"
"1","iter  30 value 25.661773
"
"1","iter  40 value 25.602910
"
"1","iter  50 value 25.454578
"
"1","iter  60 value 25.415244
"
"1","iter  70 value 25.358245
"
"1","iter  80 value 25.296059
"
"1","iter  90 value 25.142254
"
"1","iter 100 value 25.136096
"
"1","final  value 25.136096 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 55.529296 
"
"1","iter  10 value 35.860266
"
"1","iter  20 value 29.021814
"
"1","iter  30 value 28.293007
"
"1","iter  40 value 27.490082
"
"1","iter  50 value 26.941296
"
"1","iter  60 value 26.322629
"
"1","iter  70 value 25.788568
"
"1","iter  80 value 25.603357
"
"1","iter  90 value 25.590093
"
"1","iter 100 value 25.580761
"
"1","final  value 25.580761 
"
"1","stopped after 100 iterations
"
