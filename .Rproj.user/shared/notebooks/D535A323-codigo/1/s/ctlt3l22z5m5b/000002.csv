"0","set.seed(1)"
"0","dataframe.resultados.1neu <- data.frame(Ent_1Neu = numeric(),"
"0","                                        Test_1Neu = numeric())"
"0","for(i in 1:20)"
"0","{"
"0","  pacientes.1neu <- nnet( matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], class.ind( matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) , size=1)"
"0","  #Una vez que lo tengo entrenado, lo que voy a hacer es calcular el error tanto en el entrenamiento como en el test de cada uno"
"0","  "
"0","  pacientes.prediccion.1neu <- predict( pacientes.1neu, matriz.pacientes.datos.centscal[conjuntoEntrenamiento, 1:24], type=""raw"" )"
"0","  head(pacientes.prediccion.1neu) # Vemos las probabilidades de pertenencia de cada valor"
"0","  "
"0","  # Ahora que los tengo todos entrenados, Determinamos cual es la mÃ¡xima, es decir, la clase a la que hay que asignar los objetos"
"0","  "
"0","  pacientes.prediccion.1neu.class <- apply( pacientes.prediccion.1neu, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.1neu.class"
"0","  "
"0","  # Lo visualizo en forma de tabla para ir viendo el error"
"0","  "
"0","  table( pacientes.prediccion.1neu.class, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] )  # Lo vemos en forma de tabla."
"0","  "
"0","  #Calculo el acierto"
"0","  "
"0","  acierto.ent.teorico.1neu <- sum( diag( table( pacientes.prediccion.1neu.class, matriz.pacientes.etiquetas[conjuntoEntrenamiento, 25] ) ) )/55 # Esta cuenta nos da el Ã­ndice de acierto"
"0","  "
"0","  #TEST"
"0","  "
"0","  pacientes.prediccion.test.1neu <- predict( pacientes.1neu, matriz.pacientes.datos.centscal[-conjuntoEntrenamiento, 1:24], type=""raw"" )"
"0","  pacientes.prediccion.test.1neu"
"0","  "
"0","  pacientes.prediccion.test.1neu.class <- apply( pacientes.prediccion.test.1neu, MARGIN=1, FUN='which.is.max')"
"0","  pacientes.prediccion.test.1neu.class"
"0","  "
"0","  table( pacientes.prediccion.test.1neu.class , matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] )"
"0","  acierto.test.teorico.1neu <- sum( diag( table( pacientes.prediccion.test.1neu.class, matriz.pacientes.etiquetas[-conjuntoEntrenamiento, 25] ) ) )/12"
"0","  "
"0","  dataframe.pasada <- data.frame(Ent_1Neu = acierto.ent.teorico.1neu,"
"0","                                 Test_1Neu = acierto.test.teorico.1neu)"
"0","  "
"0","  dataframe.resultados.1neu <- rbind(dataframe.resultados.1neu, dataframe.pasada)"
"0","}"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 50.890878 
"
"1","iter  10 value 26.723512
"
"1","iter  20 value 24.908069
"
"1","iter  30 value 24.444626
"
"1","iter  40 value 24.093356
"
"1","iter  50 value 23.173412
"
"1","iter  60 value 22.494605
"
"1","iter  70 value 22.241333
"
"1","iter  80 value 21.409835
"
"1","iter  90 value 21.036765
"
"1","iter 100 value 20.921985
"
"1","final  value 20.921985 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.485508 
"
"1","iter  10 value 46.488139
"
"1","iter  20 value 36.801297
"
"1","iter  30 value 36.574442
"
"1","iter  40 value 30.680672
"
"1","iter  50 value 29.734517
"
"1","iter  60 value 29.687237
"
"1","iter  70 value 29.569331
"
"1","iter  80 value 29.394918
"
"1","iter  90 value 29.373674
"
"1","iter 100 value 29.320672
"
"1","final  value 29.320672 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 61.490039 
"
"1","iter  10 value 45.670607
"
"1","iter  20 value 31.284726
"
"1","iter  30 value 27.958898
"
"1","iter  40 value 27.087284
"
"1","iter  50 value 25.611942
"
"1","iter  60 value 25.000243
"
"1","iter  70 value 24.819896
"
"1","iter  80 value 24.661001
"
"1","iter  90 value 24.523905
"
"1","iter 100 value 24.053557
"
"1","final  value 24.053557 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 52.917532 
"
"1","iter  10 value 36.905104
"
"1","iter  20 value 36.589655
"
"1","iter  30 value 36.539792
"
"1","iter  40 value 35.702215
"
"1","iter  50 value 35.699574
"
"1","iter  60 value 35.690942
"
"1","iter  70 value 31.935758
"
"1","iter  80 value 31.918511
"
"1","iter  90 value 31.837352
"
"1","iter 100 value 31.562084
"
"1","final  value 31.562084 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 64.652157 
"
"1","iter  10 value 32.242604
"
"1","iter  20 value 29.469793
"
"1","iter  30 value 27.988904
"
"1","iter  40 value 26.636240
"
"1","iter  50 value 26.376451
"
"1","iter  60 value 25.814568
"
"1","iter  70 value 25.726354
"
"1","iter  80 value 25.694378
"
"1","iter  90 value 25.688188
"
"1","iter 100 value 25.677908
"
"1","final  value 25.677908 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.054636 
"
"1","iter  10 value 38.453060
"
"1","iter  20 value 37.391056
"
"1","iter  30 value 32.952109
"
"1","iter  40 value 31.743141
"
"1","iter  50 value 25.364942
"
"1","iter  60 value 25.288905
"
"1","iter  70 value 25.244784
"
"1","iter  80 value 25.208241
"
"1","iter  90 value 25.176361
"
"1","iter 100 value 25.167932
"
"1","final  value 25.167932 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 55.194090 
"
"1","iter  10 value 38.988775
"
"1","iter  20 value 38.968406
"
"1","iter  30 value 38.965611
"
"1","iter  40 value 38.961984
"
"1","iter  50 value 38.957268
"
"1","iter  60 value 38.951402
"
"1","iter  70 value 38.936729
"
"1","iter  80 value 38.642807
"
"1","iter  90 value 38.220870
"
"1","iter 100 value 38.197633
"
"1","final  value 38.197633 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.291961 
"
"1","iter  10 value 26.744655
"
"1","iter  20 value 25.536331
"
"1","iter  30 value 24.599247
"
"1","iter  40 value 24.507040
"
"1","iter  50 value 24.449261
"
"1","iter  60 value 24.437912
"
"1","iter  70 value 24.435401
"
"1","iter  80 value 24.435203
"
"1","final  value 24.435197 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 48.621479 
"
"1","iter  10 value 29.462511
"
"1","iter  20 value 27.802037
"
"1","iter  30 value 26.968896
"
"1","iter  40 value 26.632169
"
"1","iter  50 value 26.261707
"
"1","iter  60 value 26.069093
"
"1","iter  70 value 26.059793
"
"1","iter  80 value 26.055153
"
"1","iter  90 value 26.034128
"
"1","iter 100 value 23.857269
"
"1","final  value 23.857269 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 65.584553 
"
"1","iter  10 value 52.044829
"
"1","iter  20 value 37.732705
"
"1","iter  30 value 37.585312
"
"1","iter  40 value 34.801014
"
"1","iter  50 value 32.016209
"
"1","iter  60 value 31.882071
"
"1","iter  70 value 30.387820
"
"1","iter  80 value 29.955911
"
"1","iter  90 value 26.414319
"
"1","iter 100 value 26.200076
"
"1","final  value 26.200076 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 51.756360 
"
"1","iter  10 value 41.931819
"
"1","iter  20 value 41.866823
"
"1","iter  30 value 39.749070
"
"1","iter  40 value 38.989533
"
"1","iter  50 value 36.123750
"
"1","iter  60 value 31.842583
"
"1","iter  70 value 31.016268
"
"1","iter  80 value 30.651117
"
"1","iter  90 value 30.309772
"
"1","iter 100 value 30.285810
"
"1","final  value 30.285810 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.971214 
"
"1","iter  10 value 35.061250
"
"1","iter  20 value 25.541210
"
"1","iter  30 value 25.112145
"
"1","iter  40 value 24.975319
"
"1","iter  50 value 24.877148
"
"1","iter  60 value 24.835099
"
"1","iter  70 value 24.828818
"
"1","iter  80 value 24.827649
"
"1","final  value 24.827594 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 60.471468 
"
"1","iter  10 value 38.049808
"
"1","iter  20 value 36.945693
"
"1","iter  30 value 36.387434
"
"1","iter  40 value 35.647376
"
"1","iter  50 value 35.638458
"
"1","iter  60 value 35.609126
"
"1","iter  70 value 35.491283
"
"1","iter  80 value 28.973293
"
"1","iter  90 value 28.661467
"
"1","iter 100 value 28.430578
"
"1","final  value 28.430578 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 48.593881 
"
"1","iter  10 value 26.203503
"
"1","iter  20 value 25.443787
"
"1","iter  30 value 23.984770
"
"1","iter  40 value 23.155218
"
"1","iter  50 value 22.926657
"
"1","iter  60 value 22.848301
"
"1","iter  70 value 22.721071
"
"1","iter  80 value 22.675161
"
"1","iter  90 value 22.667305
"
"1","iter 100 value 22.667093
"
"1","final  value 22.667093 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 56.784127 
"
"1","iter  10 value 30.578606
"
"1","iter  20 value 26.203693
"
"1","iter  30 value 25.618630
"
"1","iter  40 value 24.909377
"
"1","iter  50 value 24.796268
"
"1","iter  60 value 24.540130
"
"1","iter  70 value 24.303729
"
"1","iter  80 value 24.112852
"
"1","iter  90 value 24.014732
"
"1","iter 100 value 24.002045
"
"1","final  value 24.002045 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 68.655640 
"
"1","iter  10 value 38.145028
"
"1","iter  20 value 35.702816
"
"1","iter  30 value 35.648164
"
"1","iter  40 value 35.639394
"
"1","iter  50 value 35.639103
"
"1","iter  60 value 35.638350
"
"1","iter  70 value 35.610539
"
"1","iter  80 value 35.500726
"
"1","iter  90 value 29.007429
"
"1","iter 100 value 28.879315
"
"1","final  value 28.879315 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 64.477882 
"
"1","iter  10 value 39.637044
"
"1","iter  20 value 36.612463
"
"1","iter  30 value 36.398443
"
"1","iter  40 value 34.849156
"
"1","iter  50 value 34.832811
"
"1","iter  60 value 34.813094
"
"1","iter  70 value 34.807064
"
"1","iter  80 value 34.802494
"
"1","iter  90 value 34.772211
"
"1","iter 100 value 34.754343
"
"1","final  value 34.754343 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 60.207609 
"
"1","iter  10 value 47.457723
"
"1","iter  20 value 31.484087
"
"1","iter  30 value 29.437895
"
"1","iter  40 value 28.255846
"
"1","iter  50 value 27.109288
"
"1","iter  60 value 26.708835
"
"1","iter  70 value 26.494792
"
"1","iter  80 value 25.661936
"
"1","iter  90 value 25.374316
"
"1","iter 100 value 24.930094
"
"1","final  value 24.930094 
"
"1","stopped after 100 iterations
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 47.407827 
"
"1","iter  10 value 26.753991
"
"1","iter  20 value 25.679773
"
"1","iter  30 value 25.645555
"
"1","iter  40 value 25.630601
"
"1","iter  50 value 25.627659
"
"1","iter  60 value 25.625330
"
"1","iter  70 value 25.624372
"
"1","final  value 25.624370 
"
"1","converged
"
"1","# weights: "
"1"," "
"1","33"
"1","
"
"1","initial  value 55.533184 
"
"1","iter  10 value 36.153099
"
"1","iter  20 value 29.440072
"
"1","iter  30 value 27.541272
"
"1","iter  40 value 26.816954
"
"1","iter  50 value 26.180487
"
"1","iter  60 value 25.742559
"
"1","iter  70 value 25.656928
"
"1","iter  80 value 25.632787
"
"1","iter  90 value 25.599641
"
"1","iter 100 value 25.571289
"
"1","final  value 25.571289 
"
"1","stopped after 100 iterations
"
